<!doctype html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="description" content="Dashboard Premium de Portafolio Cripto"/>
  <meta name="theme-color" content="#05070c"/>
  <title>HEIDI ‚Ä¢ Crypto Portfolio Command Center</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='50' fill='%237a47f3'/></svg>">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Loading Screen -->
  <div id="loadingScreen" class="loading-screen">
    <div class="loading-content">
      <div class="loading-orb"></div>
      <h2>HEIDI CRYPTO PORTFOLIO</h2>
      <p>Cargando datos en tiempo real...</p>
      <div class="loading-bar">
        <div class="loading-progress"></div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <!-- Top Bar -->
    <div class="topbar">
      <div class="brand">
        <div class="orb"></div>
        <div>
          <h1>HEIDI CRYPTO PORTFOLIO</h1>
          <p>Command Center Pro</p>
        </div>
      </div>
      <div class="controls">
        <div class="pill" id="statusPill">
          <span class="status-dot"></span>
          <span id="statusText">Cargando...</span>
        </div>
        <button class="btn btn-icon" onclick="toggleTheme()" title="Cambiar tema">
          <span id="themeIcon">‚òÄÔ∏è</span>
        </button>
        <button class="btn btn-primary" onclick="refreshData()" id="refreshBtn">
          <span class="btn-icon">‚Üª</span>
          <span>Actualizar</span>
        </button>
      </div>
    </div>

    <!-- Hero Section -->
    <div class="hero">
      <div class="heroTop">
        <div>
          <div class="subtitle">DASHBOARD EN TIEMPO REAL</div>
          <h2 class="title">
            Portafolio <span class="grad">Crypto</span>
          </h2>
          <p class="desc">
            Sincronizado autom√°ticamente con Google Sheets. 
            √öltima actualizaci√≥n: <span id="lastUpdate">--</span>
          </p>
        </div>
      </div>

      <!-- KPIs -->
      <div class="kpis">
        <div class="kpi kpi-primary">
          <div class="kpi-icon">üí∞</div>
          <div class="kpi-content">
            <div class="label">TOTAL INVERTIDO</div>
            <div class="value" id="kpiInvertido" data-value="0">$0</div>
            <div class="hint">USDT</div>
          </div>
        </div>
        <div class="kpi kpi-success">
          <div class="kpi-icon">üìä</div>
          <div class="kpi-content">
            <div class="label">VALOR ACTUAL</div>
            <div class="value" id="kpiActual" data-value="0">$0</div>
            <div class="hint">USDT</div>
          </div>
        </div>
        <div class="kpi kpi-accent">
          <div class="kpi-icon">üíé</div>
          <div class="kpi-content">
            <div class="label">P&L TOTAL</div>
            <div class="value" id="kpiPL" data-value="0">$0</div>
            <div class="hint" id="kpiPLPercent">0%</div>
          </div>
        </div>
        <div class="kpi">
          <div class="kpi-icon">ü™ô</div>
          <div class="kpi-content">
            <div class="label">ACTIVOS</div>
            <div class="value" id="kpiActivos" data-value="0">0</div>
            <div class="hint">Diferentes</div>
          </div>
        </div>
        <div class="kpi">
          <div class="kpi-icon">üìà</div>
          <div class="kpi-content">
            <div class="label">TRANSACCIONES</div>
            <div class="value" id="kpiTransacciones" data-value="0">0</div>
            <div class="hint">Total</div>
          </div>
        </div>
        <div class="kpi">
          <div class="kpi-icon">üè¶</div>
          <div class="kpi-content">
            <div class="label">EXCHANGES</div>
            <div class="value" id="kpiExchanges" data-value="0">0</div>
            <div class="hint">Plataformas</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
      <!-- Left Column -->
      <div class="left-column">
        <!-- Evoluci√≥n de Precios -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üìä EVOLUCI√ìN DE PRECIOS</h3>
              <p class="card-subtitle">Historial de precios de tus activos principales</p>
            </div>
            <div class="chart-controls">
              <button class="chip active" data-period="all">Todo</button>
              <button class="chip" data-period="30d">30D</button>
              <button class="chip" data-period="7d">7D</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="priceChart"></canvas>
          </div>
        </div>

        <!-- Curva del Portafolio -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üìà CURVA DEL PORTAFOLIO</h3>
              <p class="card-subtitle">Evoluci√≥n de inversi√≥n vs valor para validar crecimiento</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="line">L√≠nea</button>
              <button class="chip" data-view="comparative">Comparativa</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="portfolioCurveChart"></canvas>
          </div>
        </div>

        <!-- Ganancia/P√©rdida por Activo -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üíµ GANANCIA / P√âRDIDA POR ACTIVO</h3>
              <p class="card-subtitle">P&L en USD por activo. Ideal para decidir take profit o refuerzo DCA</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="barras">Barras</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="plChart"></canvas>
          </div>
        </div>

        <!-- Drawdown del Portafolio -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üìâ DRAWDOWN DEL PORTAFOLIO</h3>
              <p class="card-subtitle">Ca√≠das temporales desde m√°ximos. Mide presi√≥n y recuperaci√≥n del equity</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="riesgo">Riesgo</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="drawdownChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Right Column -->
      <div class="right-column">
        <!-- Watchlist -->
        <div class="card card-watchlist">
          <div class="cardHeader">
            <div>
              <h3>üî• WATCHLIST</h3>
              <p class="card-subtitle">Ordenado por % del portafolio. Toca un activo para ver detalles r√°pido</p>
            </div>
            <button class="chip" onclick="sortWatchlist()">
              <span>üîÑ Tap para abrir</span>
            </button>
          </div>
          <div class="watchlist" id="watchlist">
            <!-- Se llena din√°micamente -->
          </div>
        </div>

        <!-- Distribuci√≥n del Portafolio -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üç© COMPOSICI√ìN DEL PORTAFOLIO</h3>
              <p class="card-subtitle">Distribuci√≥n del capital por activo (peso). √ötil para exposici√≥n y rebalanceo</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="donut">Donut</button>
            </div>
          </div>
          <div class="canvasWrap canvasWrap-small">
            <canvas id="portfolioChart"></canvas>
          </div>
        </div>

        <!-- Mapa de Cartera -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üó∫Ô∏è MAPA DE CARTERA</h3>
              <p class="card-subtitle">Cada burbuja: % portafolio (X) vs ROI (Y). Tama√±o = valor. Detecta concentraci√≥n y ganadores</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="bubble">Bubble</button>
            </div>
          </div>
          <div class="canvasWrap canvasWrap-small">
            <canvas id="bubbleChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabla Profesional -->
    <div class="card card-table">
      <div class="cardHeader">
        <div>
          <h3>üìã TABLA PROFESIONAL</h3>
          <p class="card-subtitle">Vista completa por activo: invertido, valor, P&L, ROI y precio. Dise√±ado para revisi√≥n r√°pida</p>
        </div>
        <div class="table-controls">
          <button class="chip">Gesti√≥n 2026</button>
        </div>
      </div>
      <div class="table-container">
        <table id="professionalTable">
          <thead>
            <tr>
              <th>ACTIVO</th>
              <th>INVERTIDO</th>
              <th>VALOR</th>
              <th>P&L</th>
              <th>ROI</th>
              <th>PRECIO</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr>
              <td colspan="6" class="loading-cell">
                <div class="spinner"></div>
                <p>Cargando datos desde Google Sheets...</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>¬© 2026 Banal ‚Ä¢ HEIDY Portfolio Command Center ‚Ä¢ Dashboard ejecutivo ‚Ä¢ UX Pro ‚Ä¢ iOS/Android</p>
      <p class="footer-disclaimer">Este dashboard es una herramienta de visualizaci√≥n, no constituye recomendaci√≥n financiera ni asesoramiento de inversi√≥n.</p>
      <p class="footer-note">Uso interno / demo. Los datos pueden diferir de fuentes externas seg√∫n timestamps, spreads y metodolog√≠a mark-to-market.</p>
    </div>
  </div>

  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
