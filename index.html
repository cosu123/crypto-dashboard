<!doctype html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="description" content="Dashboard Premium de Portafolio Cripto"/>
  <meta name="theme-color" content="#05070c"/>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Expires" content="0"/>
  <title>HEIDI ‚Ä¢ Crypto Portfolio Command Center v2.0</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='50' fill='%237a47f3'/></svg>">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Loading Screen -->
  <div id="loadingScreen" class="loading-screen">
    <div class="loading-content">
      <div class="loading-orb"></div>
      <h2>HEIDI CRYPTO PORTFOLIO</h2>
      <p>Cargando datos en tiempo real...</p>
      <div class="loading-bar">
        <div class="loading-progress"></div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <!-- Top Bar -->
    <div class="topbar">
      <div class="brand">
        <div class="orb"></div>
        <div>
          <h1>HEIDI CRYPTO PORTFOLIO</h1>
          <p>Command Center Pro</p>
        </div>
      </div>
      <div class="controls">
        <div class="pill" id="statusPill">
          <span class="status-dot"></span>
          <span id="statusText">Cargando...</span>
        </div>
        <button class="btn btn-icon" onclick="toggleTheme()" title="Cambiar tema" aria-label="Cambiar tema claro/oscuro">
          <span id="themeIcon">‚òÄÔ∏è</span>
        </button>
        <button class="btn btn-primary" onclick="refreshData()" id="refreshBtn" aria-label="Actualizar datos del portafolio">
          <span class="btn-icon">‚Üª</span>
          <span>Actualizar</span>
        </button>
      </div>
    </div>

    <!-- Hero Section -->
    <div class="hero">
      <div class="heroTop">
        <div>
          <div class="subtitle">DASHBOARD EN TIEMPO REAL</div>
          <h2 class="title">
            Portafolio <span class="grad">Crypto</span>
          </h2>
          <p class="desc">
            Sincronizado autom√°ticamente con Google Sheets. 
            √öltima actualizaci√≥n: <span id="lastUpdate">--</span>
          </p>
        </div>
      </div>

      <!-- KPIs -->
      <div class="kpis">
        <div class="kpi kpi-primary">
          <div class="kpi-icon">üí∞</div>
          <div class="kpi-content">
            <div class="label">TOTAL INVERTIDO</div>
            <div class="value" id="kpiInvertido" data-kpi="total-invertido" data-value="0">$0</div>
            <div class="hint">USDT</div>
          </div>
        </div>
        <div class="kpi kpi-success">
          <div class="kpi-icon">üìä</div>
          <div class="kpi-content">
            <div class="label">VALOR ACTUAL</div>
            <div class="value" id="kpiActual" data-kpi="valor-actual" data-value="0">$0</div>
            <div class="hint">USDT</div>
          </div>
        </div>
        <div class="kpi kpi-accent">
          <div class="kpi-icon">üíé</div>
          <div class="kpi-content">
            <div class="label">P&L TOTAL</div>
            <div class="value" id="kpiPL" data-kpi="pl-total" data-value="0">$0</div>
            <div class="hint" id="kpiPLPercent" data-kpi="roi-percent">0%</div>
          </div>
        </div>
        <div class="kpi">
          <div class="kpi-icon">ü™ô</div>
          <div class="kpi-content">
            <div class="label">ACTIVOS</div>
            <div class="value" id="kpiActivos" data-kpi="activos" data-value="0">0</div>
            <div class="hint">Diferentes</div>
          </div>
        </div>
        <div class="kpi">
          <div class="kpi-icon">üìà</div>
          <div class="kpi-content">
            <div class="label">TRANSACCIONES</div>
            <div class="value" id="kpiTransacciones" data-kpi="transacciones" data-value="0">0</div>
            <div class="hint">Total</div>
          </div>
        </div>
        <div class="kpi">
          <div class="kpi-icon">üè¶</div>
          <div class="kpi-content">
            <div class="label">EXCHANGES</div>
            <div class="value" id="kpiExchanges" data-kpi="exchanges" data-value="0">0</div>
            <div class="hint">Plataformas</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Gr√°fico de Objetivo -->
    <div class="card card-goal" style="margin: 1.5rem 0;">
      <div class="cardHeader">
        <div>
          <h3>üéØ OBJETIVO DE INVERSI√ìN</h3>
          <p class="card-subtitle">Progreso hacia tu meta de $5,000 USDT</p>
        </div>
      </div>
      <div style="padding: 2rem;">
        <!-- Grid de 2 columnas: Gauge + Stats -->
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 2rem; align-items: center;">
          <!-- Gauge Chart -->
          <div style="position: relative;">
            <div class="canvasWrap" style="height: 200px; width: 200px; margin: 0 auto;">
              <canvas id="goalChart"></canvas>
            </div>
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; pointer-events: none;">
              <div style="font-size: 2rem; font-weight: bold; color: #00ff88;" id="goalProgressCenter">0%</div>
              <div style="font-size: 0.75rem; color: #888; margin-top: 0.25rem;">Completado</div>
            </div>
          </div>
          
          <!-- Stats Grid -->
          <div class="goal-stats" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
            <div class="goal-stat" style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);">
              <div class="goal-label" style="font-size: 0.85rem; color: #888; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em;">Inversi√≥n Actual</div>
              <div class="goal-value" style="font-size: 1.75rem; font-weight: bold; color: #fff;">$0</div>
            </div>
            <div class="goal-stat" style="background: rgba(0,212,255,0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(0,212,255,0.3);">
              <div class="goal-label" style="font-size: 0.85rem; color: #888; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em;">Objetivo</div>
              <div class="goal-value" style="font-size: 1.75rem; font-weight: bold; color: #00d4ff;">$5,000</div>
            </div>
            <div class="goal-stat" style="background: rgba(255,107,157,0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(255,107,157,0.3);">
              <div class="goal-label" style="font-size: 0.85rem; color: #888; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em;">Falta</div>
              <div class="goal-value" style="font-size: 1.75rem; font-weight: bold; color: #ff6b9d;">$0</div>
            </div>
            <div class="goal-stat" style="background: rgba(0,255,136,0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(0,255,136,0.3);">
              <div class="goal-label" style="font-size: 0.85rem; color: #888; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em;">Progreso</div>
              <div class="goal-value" style="font-size: 1.75rem; font-weight: bold; color: #00ff88;">0%</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
      <!-- Left Column -->
      <div class="left-column">
        <!-- Evoluci√≥n de Precios -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üìä EVOLUCI√ìN DE PRECIOS</h3>
              <p class="card-subtitle">Historial de precios de tus activos principales</p>
            </div>
            <div class="chart-controls" role="group" aria-label="Selecci√≥n de per√≠odo">
              <button class="chip active" data-period="all" aria-label="Ver todos los datos">Todo</button>
              <button class="chip" data-period="30d" aria-label="Ver √∫ltimos 30 d√≠as">30D</button>
              <button class="chip" data-period="7d" aria-label="Ver √∫ltimos 7 d√≠as">7D</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="priceChart"></canvas>
          </div>
        </div>

        <!-- Curva del Portafolio -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üìà CURVA DEL PORTAFOLIO</h3>
              <p class="card-subtitle">Evoluci√≥n de inversi√≥n vs valor para validar crecimiento</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="line">L√≠nea</button>
              <button class="chip" data-view="comparative">Comparativa</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="portfolioCurveChart"></canvas>
          </div>
        </div>

        <!-- Ganancia/P√©rdida por Activo -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üíµ GANANCIA / P√âRDIDA POR ACTIVO</h3>
              <p class="card-subtitle">P&L en USD por activo. Ideal para decidir take profit o refuerzo DCA</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="barras">Barras</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="plChart"></canvas>
          </div>
        </div>

        <!-- Drawdown del Portafolio -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üìâ DRAWDOWN DEL PORTAFOLIO</h3>
              <p class="card-subtitle">Ca√≠das temporales desde m√°ximos. Mide presi√≥n y recuperaci√≥n del equity</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="riesgo">Riesgo</button>
            </div>
          </div>
          <div class="canvasWrap">
            <canvas id="drawdownChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Right Column -->
      <div class="right-column">
        <!-- Watchlist -->
        <div class="card card-watchlist">
          <div class="cardHeader">
            <div>
              <h3>üî• WATCHLIST</h3>
              <p class="card-subtitle">Ordenado por % del portafolio. Toca un activo para ver detalles r√°pido</p>
            </div>
            <button class="chip" onclick="sortWatchlist()" aria-label="Abrir watchlist de activos">
              <span>üîÑ Tap para abrir</span>
            </button>
          </div>
          <div class="watchlist" id="watchlist">
            <!-- Se llena din√°micamente -->
          </div>
        </div>

        <!-- Distribuci√≥n del Portafolio -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üç© COMPOSICI√ìN DEL PORTAFOLIO</h3>
              <p class="card-subtitle">Distribuci√≥n del capital por activo (peso). √ötil para exposici√≥n y rebalanceo</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="donut">Donut</button>
            </div>
          </div>
          <div class="canvasWrap canvasWrap-small">
            <canvas id="portfolioChart"></canvas>
          </div>
        </div>

        <!-- Mapa de Cartera -->
        <div class="card card-chart">
          <div class="cardHeader">
            <div>
              <h3>üó∫Ô∏è MAPA DE CARTERA</h3>
              <p class="card-subtitle">Cada burbuja: % portafolio (X) vs ROI (Y). Tama√±o = valor. Detecta concentraci√≥n y ganadores</p>
            </div>
            <div class="chart-toggle">
              <button class="chip active" data-view="bubble">Bubble</button>
            </div>
          </div>
          <div class="canvasWrap canvasWrap-small">
            <canvas id="bubbleChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabla Profesional -->
    <div class="card card-table">
      <div class="cardHeader">
        <div>
          <h3>üìã TABLA PROFESIONAL</h3>
          <p class="card-subtitle">Vista completa por activo: invertido, valor, P&L, ROI y precio. Dise√±ado para revisi√≥n r√°pida</p>
        </div>
        <div class="table-controls">
          <button class="chip">Gesti√≥n 2026</button>
        </div>
      </div>
      <div class="table-container">
        <table id="professionalTable">
          <thead>
            <tr>
              <th>ACTIVO</th>
              <th>INVERTIDO</th>
              <th>VALOR</th>
              <th>P&L</th>
              <th>ROI</th>
              <th>PRECIO</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr>
              <td colspan="6" class="loading-cell">
                <div class="spinner"></div>
                <p>Cargando datos desde Google Sheets...</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>¬© 2026 Banal ‚Ä¢ HEIDY Portfolio Command Center ‚Ä¢ Dashboard ejecutivo ‚Ä¢ UX Pro ‚Ä¢ iOS/Android</p>
      <p class="footer-disclaimer">Este dashboard es una herramienta de visualizaci√≥n, no constituye recomendaci√≥n financiera ni asesoramiento de inversi√≥n.</p>
      <p class="footer-note">Uso interno / demo. Los datos pueden diferir de fuentes externas seg√∫n timestamps, spreads y metodolog√≠a mark-to-market.</p>
    </div>
  </div>

  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
